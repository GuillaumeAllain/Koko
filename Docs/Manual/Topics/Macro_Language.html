<!DOCTYPE html>
<html>
<head>
<meta name="generator" content=
"HTML Tidy for HTML5 for Linux version 5.6.0">
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<style type="text/css">
@import url('https://themes.googleusercontent.com/fonts/css?kit=r3oQQBWBLofdqMg7XagtpryACU-dpWPXZrZUPlWEcIiNCBPJbL2oU7-eTA7xvzL3wWgnOE3tsA31tgW5mglLMw');ol.lst-kix_list_1-3{list-style-type:none}ol.lst-kix_list_1-4{list-style-type:none}ol.lst-kix_list_1-5{list-style-type:none}ol.lst-kix_list_1-6{list-style-type:none}ol.lst-kix_list_1-0{list-style-type:none}.lst-kix_list_1-4>li{counter-increment:lst-ctn-kix_list_1-4}ol.lst-kix_list_1-1{list-style-type:none}ol.lst-kix_list_1-2{list-style-type:none}ol.lst-kix_list_1-6.start{counter-reset:lst-ctn-kix_list_1-6 0}.lst-kix_list_1-1>li{counter-increment:lst-ctn-kix_list_1-1}ol.lst-kix_list_1-3.start{counter-reset:lst-ctn-kix_list_1-3 0}ol.lst-kix_list_1-2.start{counter-reset:lst-ctn-kix_list_1-2 0}ol.lst-kix_list_1-8.start{counter-reset:lst-ctn-kix_list_1-8 0}.lst-kix_list_1-0>li:before{content:" "}ol.lst-kix_list_1-5.start{counter-reset:lst-ctn-kix_list_1-5 0}ol.lst-kix_list_1-7{list-style-type:none}.lst-kix_list_1-1>li:before{content:" "}.lst-kix_list_1-2>li:before{content:" "}.lst-kix_list_1-7>li{counter-increment:lst-ctn-kix_list_1-7}ol.lst-kix_list_1-8{list-style-type:none}.lst-kix_list_1-3>li:before{content:" "}.lst-kix_list_1-4>li:before{content:" "}ol.lst-kix_list_1-0.start{counter-reset:lst-ctn-kix_list_1-0 0}.lst-kix_list_1-0>li{counter-increment:lst-ctn-kix_list_1-0}.lst-kix_list_1-6>li{counter-increment:lst-ctn-kix_list_1-6}.lst-kix_list_1-7>li:before{content:" "}.lst-kix_list_1-3>li{counter-increment:lst-ctn-kix_list_1-3}.lst-kix_list_1-5>li:before{content:" "}.lst-kix_list_1-6>li:before{content:" "}ol.lst-kix_list_1-7.start{counter-reset:lst-ctn-kix_list_1-7 0}.lst-kix_list_1-2>li{counter-increment:lst-ctn-kix_list_1-2}.lst-kix_list_1-5>li{counter-increment:lst-ctn-kix_list_1-5}.lst-kix_list_1-8>li{counter-increment:lst-ctn-kix_list_1-8}ol.lst-kix_list_1-4.start{counter-reset:lst-ctn-kix_list_1-4 0}.lst-kix_list_1-8>li:before{content:" "}ol.lst-kix_list_1-1.start{counter-reset:lst-ctn-kix_list_1-1 0}ol{margin:0;padding:0}table td,table th{padding:0}.c20{border-right-style:solid;padding:0pt 4pt 0pt 4pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;width:234pt;border-top-color:#000000;border-bottom-style:solid}.c8{-webkit-text-decoration-skip:none;text-decoration:underline;vertical-align:baseline;text-decoration-skip-ink:none;font-style:normal}.c17{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:center}.c15{margin-left:auto;border-spacing:0;border-collapse:collapse;margin-right:auto}.c2{font-size:9pt;font-family:"Times New Roman";color:#0000ff;font-weight:700}.c0{font-size:9pt;font-family:"Times New Roman";color:#ff0000;font-weight:700}.c10{color:#008000;text-decoration:none;vertical-align:baseline;font-style:normal}.c19{color:#0000ff;font-weight:700;font-size:16pt;font-family:"Times New Roman"}.c6{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:justify}.c14{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c3{color:#000000;text-decoration:none;vertical-align:baseline;font-style:normal}.c4{font-weight:400;font-size:12pt;font-family:"Times New Roman"}.c12{text-decoration:none;vertical-align:baseline;font-style:normal}.c24{background-color:#ffffff;max-width:504pt;padding:36pt 36pt 53.2pt 72pt}.c22{font-weight:400;font-size:12pt;font-family:"Palatino"}.c21{-webkit-text-decoration-skip:none;text-decoration:underline;text-decoration-skip-ink:none}.c1{font-size:9pt;font-family:"Times New Roman";font-weight:400}.c5{font-weight:700;font-size:9pt;font-family:"Times New Roman"}.c18{orphans:2;widows:2}.c23{color:#ff0000}.c25{vertical-align:baseline}.c11{color:#008000}.c7{height:12pt}.c9{color:#000000}.c16{vertical-align:sub}.c13{height:0pt}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Times New Roman";line-height:1.0;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.0;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:12pt;font-family:"Times New Roman"}p{margin:0;color:#000000;font-size:12pt;font-family:"Times New Roman"}h1{padding-top:12pt;-webkit-text-decoration-skip:none;color:#000000;font-weight:700;text-decoration:underline;font-size:12pt;padding-bottom:0pt;line-height:1.0;text-decoration-skip-ink:none;font-family:"Helvetica Neue";orphans:2;widows:2;text-align:left}h2{padding-top:6pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:0pt;font-family:"Helvetica Neue";line-height:1.0;orphans:2;widows:2;text-align:left}h3{padding-top:0pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:0pt;font-family:"Times";line-height:1.0;orphans:2;widows:2;text-align:left}h4{padding-top:0pt;-webkit-text-decoration-skip:none;color:#000000;text-decoration:underline;text-decoration-skip-ink:none;font-size:12pt;padding-bottom:0pt;font-family:"Times";line-height:1.0;orphans:2;widows:2;text-align:left}h5{padding-top:0pt;color:#000000;font-weight:700;font-size:10pt;padding-bottom:0pt;font-family:"Times";line-height:1.0;orphans:2;widows:2;text-align:left}h6{padding-top:0pt;-webkit-text-decoration-skip:none;color:#000000;text-decoration:underline;text-decoration-skip-ink:none;font-size:10pt;padding-bottom:0pt;font-family:"Times";line-height:1.0;orphans:2;widows:2;text-align:left}
</style>
<title></title>
</head>
<body class="c24">
<p class="c7 c14"></p>
<p class="c6"><span class=
"c2">MACROS-INTRODUCTION</span><span class="c1">&nbsp;- The macro
processor is a powerful and useful built-in programming language
feature which provides a means of programming any of the many
program commands into macros and/or macro functions. Each macro can
be given its own user-specified name. After creation, a macro or
macro function is executed exactly as any program command by
entering its name on the command line and pressing enter. Up to 999
macros may be defined and stored in an easy-to-use macro library.
Of these 999 possible macros, 10 may be defined as macro functions.
Each macro or macro function may consist of up to 1024 lines,
including comments and the end-of-macro instruction "EOM". Each
macro or macro function line may contain any program command, any
pre-existing macro name or pre-existing macro function name as well
as a host of macro processor specific commands . Macros may call
other macros in nests up to 20 macros deep without loss of stored
data.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">THE MACRO
DIRECTORY</span><span class="c1">&nbsp;- All user-created macros
are stored (by default) in the directory LIBMAC which resides just
below the directory containing the PRG.EXE file. The macro
directory file (not to be confused with an operating system disk
directory) is the file named MAC.DAT. The macro body records
comprising each macro and macro function are contained in up to 999
files with names which range from MAC001.DAT to MAC999.DAT.
Whenever a macro name is input as a program command from the CMD
level, the appropriate macro is loaded into memory from the macro
directory file and then its component commands are executed. Macros
are stored in a pre-parsed, semi-compiled format which enhances
speed of execution.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO DIRECTORY
INITIALIZATION</span><span class="c1">&nbsp;- Don't use these two
next commands if you already have macros unless you want to destroy
them! The MACRO library directory file MAC.DAT can be created new
by entering the CMD level command:</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">IMF</span><span class="c1">&nbsp;-
This command followed by the "PROCEED" command will erase all
existing macros, so use them only when establishing a new macro
library. To avoid accidental destruction of the existing MACRO
library, the "IMF" command performs no file initialization unless
it is &nbsp;followed immediately by the "PROCEED"
command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">PROCEED</span><span class=
"c1">&nbsp;- If the CMD level command "PROCEED" is not immediately
entered following the "IMF" command, then the "IMF" command is
ignored and canceled.</span> <span class="c1">THIS INITIALIZATION
PROCEDURE SHOULD BE USED WITH EXTREME CAUTION AS LARGE AMOUNTS OF
DATA MAY BE LOST IF IT IS USED CARELESSLY.</span><span class=
"c1">&nbsp;The "IMF" command is intended for a user who has no
macro directory file or for a user who intentionally desires to
clean the slate and begin anew with an empty macro directory file.
It is also used by the program when establishing alternate macro
directory files in other disk directories. The following pair of
commands will erase all existing macros and flush the macro
directory. Use them with caution.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c10 c5">IMF</span></p>
<p class="c6"><span class="c10 c5">PROCEED</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">ALTERNATE MACRO
DIRECTORIES</span><span class="c1">&nbsp;- The user may create and
use alternate macro directories using the CMD level commands
"MACDIR" or "CHGMAC". These commands are also described here and in
the CMD section of the manual.</span></p>
<p class="c6 c7"></p>
<p class="c6 c18"><span class="c0">MACDIR or CHGMAC , (qualifier
word)</span><span class="c1">&nbsp; &nbsp;- By default when the
program begins execution, the macro library is located in the
directory LIBMAC which sits just below the directory into which the
main program was installed and from which the main program runs.
The "MACDIR" command is used to change the current macro library
directory to the directory named by the first six characters of the
"qualifier word". If this directory exists, then only the internal
program pointer, pointing to the macro library directory, is
changed. If the directory does not yet exist, it is created. After
creation of a new macro library directory, a new macro library must
be initialized in this new directory via the "IMF" and "PROCEED"
commands. The "MACDIR" command makes it possible to have access to
as many macro libraries as desired, only limited by available disk
space. If "MACDIR" is issued followed by a "?", the name of the
current macro library directory will be displayed. The new
directory name designated by the "qualifier word" must contain
exactly six non-blank characters.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">PERMANENT MACROS</span><span class=
"c1">&nbsp;- Permanent macros are provided with the program and
stored in the PERMAC directory. In order to list, edit, create or
delete a permanent macro, change to the PERMAC directory, perform
the macro operation and then, return to the default macro library
directory. The example below, shows how to load the manufacturers
lens librarys after the program is first installed. To run a
permanent macro, simply issue the macro name. The program
automatically searches the permanent macro library if the macro
name issued is not in the current macro directory.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c10 c5">LODLENS</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO FUNCTIONS</span><span class=
"c1">&nbsp;- Macro functions are very much like ordinary macros in
that they are created, filed and executed just like macros. For a
macro to be a macro function, it must be named either "FUN01",
"FUN02", "FUN03", "FUN04", "FUN05", "FUN06", "FUN07", "FUN08",
"FUN09","FUN10". A macro with one of these 10 reserved names is not
only stored on disk as a regular macro but also kept in live
computer memory while the program runs. When one of these macro
functions is to be executed, it will be executed "from memory". The
process of looking the macro up in the file "MAC.DAT" and then
loading the macro from disk to memory is avoided. Macro functions
execute many times faster than ordinary macros. This is why they
are used in some types of optimization, tolerancing and special
surface shape definition. For the rest of this section, macros and
macro functions will be referred to simply as macros. When the
program first begins to execute, a search of the macro directory
file is performed. If there are macros with the reserved macro
function names in the macro directory file, they are loaded into
memory. If these functions are modified or deleted during program
execution using the macro directory file manipulation commands, the
macro function memory areas and the macro directory file are
modified appropriately.</span></p>
<hr style="page-break-before:always;display:none;">
<p class="c6"><span class="c2">NEW PROGRAM
COMMANDS</span><span class="c1">&nbsp;- After creation and filing,
a macro may be used just as a program command is used. The specific
form may vary, but the general form is identical to the command
input forms described in the INTRO SECTION. The exception is that
no explicit provision is made for recognition of the interrogator
symbol " ? ".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO INVOCATION
LINE</span><span class="c1">&nbsp;- The program command line into
which is typed a macro name in order to execute that macro will
henceforth be known as the macro invocation</span><span class=
"c5">&nbsp;</span><span class="c1">line.</span> <span class="c0">ON
THE MACRO INVOCATION LINE ONLY, IF A STRING IS TO BE INPUT, IT MUST
BE PECEEDED BY A COLON (:) SO IF THE STRING</span> <span class=
"c5 c11">RTG</span><span class="c0">&nbsp;IS TO BE INPUT AS A
STRING, IT MUST BE INPUT AS</span> <span class=
"c5 c11">:RTG</span><span class="c0">. THIS IS THE ONLY PLACE IN
THE PROGRAM WHERE A STRING MUST BE PRECEEDED BY A COLON.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">ELEMENTS OF A
MACRO</span><span class="c1">&nbsp;- A macro consists of the
following elements:</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO HEADER</span><span class=
"c1">&nbsp;- The "MACRO" command followed by a unique user defined
name up to 8 characters long is known as the macro
header.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">BODY OF THE MACRO</span><span class=
"c1">&nbsp;- The body of a macro may contain any combination of the
regular program commands as well as special macro processing
commands which will be described later in this section. Essentially
any program command which may be issued from the keyboard may be
included in the body of a macro. All commands within the macro body
are processed sequentially unless special branching commands occur
which change that sequential order.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO PROCESSING
COMMANDS</span><span class="c1">&nbsp;- Commands which are valid
only inside a macro and which act to modify the execution of a
macro may be included in a macro. These commands may modify the
order of macro execution, may allow external or internal data
transfer and may turn on or off the macro execution tracing and
single step execution features.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">END OF MACRO</span><span class=
"c1">&nbsp;- The last line in every macro must be "EOM" which
stands for "End Of Macro".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO EXAMPLES</span><span class=
"c1">&nbsp;- For the impatient, here ere two sample macros, one
simple, one not so simple. More examples or fragments of samples
will be found later in this section.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c3 c1">First, a simple macro. It is just
a series of program commands which will execute sequentially. It is
used to display both the final surface, paraxial marginal ray
height in the YZ-plane and also the EFL, BFL and FFL of the current
lens. These commands may be typed into the command line one at a
time if desired. A simpler macro editing and macro creation tool
will be discussed in a page or two.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c5 c11">MACRO
GETPY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(initializes
the macro)</span></p>
<p class="c6"><span class="c5 c11">SHO
PY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(move
the marginal paraxial ray height value, PY, at the final surface of
the current lens to the X-register and displays it)</span></p>
<p class="c6"><span class=
"c5 c11">FIRD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(display
the EFL, BFL and FFL for the current lens)</span></p>
<p class="c6"><span class=
"c5 c11">EOM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(End
Of Macro line)</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c3 c1">The next macro is a modification
of part of the first macro. It allows the user to input the surface
number for which the marginal and chief ray heights are to be
displayed. If no surface number is issued as the first numeric word
of the macro invocation line, then final surface values will be
displayed.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c5 c11">MACRO
GETPYPCY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(initialize
the macro)</span></p>
<p class="c6"><span class="c5 c11">NSUB DV
–10,,,,,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(set
the default value of the first numeric word to –10)</span></p>
<p class="c6"><span class="c5 c11">NSUB 0
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(move
the first numeric word of the macro invocation line into the
X-register a.k.a "the accumulator")</span></p>
<p class="c6"><span class="c5 c11">BNEG
A1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(if
the X-register is negative, branch to the branch point
A1)</span></p>
<p class="c6"><span class="c5 c11">BRU
A2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(branch
unconditionally to branch point A2)</span></p>
<p class="c6"><span class="c5 c11">BP
A1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(branch
point A1)</span></p>
<p class="c6"><span class="c5 c11">GET
ISN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(get
the image surface number and put it into the X-register)</span></p>
<p class="c6"><span class="c5 c11">BP
A2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(branch
point A2)</span></p>
<p class="c6"><span class="c5 c11">NSUB 1
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(move
the value in the X-register into the first numeric word of the next
command)</span></p>
<p class="c6"><span class="c5 c11">SHO
PY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(show
the PY value at the surface number designated by the first numeric
word)</span></p>
<p class="c6"><span class="c5 c11">NSUB 1
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(move
the value in the X-register into the first numeric word of the next
&nbsp;command)</span></p>
<p class="c6"><span class="c5 c11">SHO
PCY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c11">(</span><span class="c1 c9">show
the PCY value at the surface number designated by the first numeric
word)</span></p>
<p class="c6"><span class=
"c5 c11">EOM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c1 c9">(End
Of Macro line)</span></p>
<hr style="page-break-before:always;display:none;">
<p class="c6"><span class="c2">MACRO CREATION</span><span class=
"c1">&nbsp;- As mentioned before, a macro can be created by simple
typing it in, one line at a time at the program command prompt.
&nbsp;If you do this, it is important to understand what the
"MACRO" and "EOM" commands do. Here are the definitions but don't
worry about them too much because the next method of macro creation
takes care of these two commands automatically.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MACRO (macro
name)</span><span class="c1">&nbsp; - The "macro name" should not
duplicate the name of a CMD level or macro processor command since
all program input commands are always checked against a program
command vocabulary list prior to checking against the macro name
directory. A macro with the same name as a program command,
therefore, can never be executed. The "MACRO" command causes the
program to be shifted to the MACRO creation level from the CMD
level.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">ENDING MACRO
CREATION</span><span class="c1">&nbsp;- As mentioned before,
termination of macro creation is performed with the
command:</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">EOM</span><span class="c1">&nbsp;-
The "EOM" command terminates macro creation. If there are macro
lines present in memory, the macro is filed in the macro directory
file. If no macro lines are present in memory, no macro is filed.
The program then returns to the CMD level.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO NAME RULES</span><span class=
"c1">&nbsp;- Each macro must have a unique name. Macros with
identical names are not allowed. A previous macro of the same name
is automatically deleted before the new same-named macro is
created.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO DELETION</span><span class=
"c1">&nbsp;- A macro may be explicitly deleted from the macro
directory file with the command:</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MDEL (macro name)</span><span class=
"c1">&nbsp; - If the named macro is not found in the macro
directory file, a message to that effect is issued and the command
is ignored. "MDEL" may be issued as a command from within a macro
and; therefore, a macro may be written which executes and then
deletes itself! I personally think that is pretty cool!</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO EDITING
METHODS</span><span class="c1">&nbsp;- Macro editing/creation may
be performed in two distinctly different ways. The first way is
implemented using the "LMEDIT" command and its associated built-in
line oriented editor. This method will be discussed at the end of
this macro section. It was the original macro editor before full
screen editing was available. (Remember DOS?). It is not of much
use now but it has been left in the program for use by users who
learned this early edit method and who like the pain it produces in
their head. The second and best method is a full screen edit mode.
The user simply uses the "MEDIT" command described
below.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MEDIT (macro name</span><span class=
"c1 c23">)</span><span class="c1">&nbsp; - The "MEDIT" command can
be used either to initiate editing of an existing macro or to
create a new macro in the full screen macro-edit (medit) mode. If a
macro with the name (macro name) exists, it is automatically sent
to the macro full screen editor. If the macro does not exist, and
empty macro with the specified name is opened with the program full
screen editor. When the full screen editor is closed, the edited
macro is read back into the macro directory before the next command
is executed in the main program. It may then be listed or executed.
After entering the full screen mode, any commands may be placed
between the macro header line (the one that starts with the word
MACRO) and the "EOM" command. In the full screen mode, a HELP menu
is available which opens this MACRO manual section as a PDF
file.</span></p>
<p class="c6"><span class="c3 c1">NOTE: This command may also be
issued via the main program GUI interface menu system.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MREFRESH</span> <span class=
"c1">&nbsp;- The "MREFRESH" command can be issued from the CMD
level during full screen macro editing. It moves the latest version
of the existing macro, from the full screen editor's buffer into
the current macro file directory. The macro may then &nbsp;be
listed or executed.</span></p>
<p class="c6"><span class="c3 c1">NOTE: This command may also be
issued via the main program GUI interface menu system.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO DIRECTORY
STATUS</span><span class="c1">&nbsp;- The status and contents of
the macro directory file may be interrogated by entering one or
more of the following commands from the program CMD
level:</span></p>
<p class="c6"><span class="c3 c1">NOTE: These commands may also be
issued via the main program GUI interface menu system.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">LIST ALL MACROS</span></p>
<p class="c17 c7"></p>
<p class="c6"><span class="c0">MFL</span><span class="c1">&nbsp;-
The "MFL" command causes all macros to be displayed in their
entirety.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">LIST ALL MACRO NAMES</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MFLN</span><span class="c1">&nbsp;-
The "MFLN" command causes a condensed listing of the names,
creation times and dates and the first 40 characters of each
macro's first comment line.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">LIST A SPECIFIC MACRO</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MFL</span><span class=
"c1">&nbsp;(macro name) - This version of the "MFL" command causes
all lines comprising the named macro to be listed. If no name is
included, &nbsp;all the macros are listed. That mode is useful when
outputting all macros to a disk file for backup.</span></p>
<hr style="page-break-before:always;display:none;">
<p class="c6"><span class="c2">LIST MACRO COMMENTS</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MFLC (macro name)</span><span class=
"c1">&nbsp; - The "MFLC" command causes all leading comment lines
of the named macro to be listed.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MSTAT</span><span class="c1">&nbsp;-
The "MSTAT" command generates a message indicating the number of
macros currently on file and the remaining number of empty spaces
in the macro directory file. &nbsp;The "MFLN" and "MSTAT" commands
are combined into one menu item.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO PROCESSING
COMMANDS</span><span class="c5">&nbsp;</span><span class=
"c1">&nbsp;- Besides being allowed to put almost every program
command into a macro, there are special macro processing commands
available. These commands can, among other things, &nbsp;control
the sequence in which a macro executes.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">INDEXING COMMANDS</span><span class=
"c1">&nbsp;- In order to facilitate the construction of loops and
to assist in the transfer of sequenced items of data, six index
storage registers are provided. These registers are named "I",
"J","K", "L", "M" and"N". Their specific use is discussed in the
section on conditional branching commands. Associated with these
registers are the test values "ITEST", "JTEST", "KTEST", "LTEST",
"MTEST" and "NTEST". The values in these test registers are used in
connection with the specific branching commands which test the
contents of the index registers "I", "J","K", "L", "M" and "N". The
index registers and the test registers are initialized to zero at
the start of program execution. Only one register name at a time
can be used with the "SET" command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">SET (I, J, K, L, M, N, ITEST, JTEST,
KTEST, LTEST, MTEST or NTEST) , i</span><span class="c1">&nbsp; -
This version of the "SET" command causes the register named by the
qualifier word ("I", "J","K", "L", "M", "N", "ITEST", "JTEST",
"KTEST", "LTEST", "MTEST" or "NTEST") to be set to the value of
"i". The numeric value can be positive or negative and is stored as
a double precision. There is a short cut to setting these
registers. Enter the register name with an equal sign appended, a
space or comma (necessary) and the numerical value to which the
register is to be set.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c5 c9">Example:</span><span class=
"c5 c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET ITEST,
25.4 (or) ITEST= 25.4</span><span class="c5">&nbsp;sets the ITEST
register to 25.4</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MOVE (I, J, K, L, M, N, ITEST,
JTEST, KTEST, LTEST, MTEST or NTEST)</span><span class="c1">&nbsp;
- The "MOVE" command "moves" the numeric value stored in the
register indicated by the qualifier word ("I", "J","K", "L", "M",
"N", "ITEST", "JTEST", "KTEST", "LTEST", "MTEST" or "NTEST") into
the accumulator register. ("MOVE" generally moves a value to the
accumulator which is also called the X-register). "MOVE" may be
used with all named registers as well as these "test"
registers.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c5 c9">Example:</span><span class=
"c5 c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE
ITEST</span><span class="c5">&nbsp;moves the value in the ITEST
into the X-register</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">STORE (I, J, K, L, M, N, ITEST,
JTEST, KTEST, LTEST, MTEST or NTEST)</span><span class="c1">&nbsp;
- The "STORE" command causes the number in the accumulator to be
stored in the register indicated by the qualifier word ("I",
"J","K", "L", "M", "N", "ITEST", "JTEST", "KTEST", "LTEST", "MTEST"
or "NTEST"). "STORE" may be used with all named
registers.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c5 c9">Example:</span><span class=
"c5 c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STORE
ITEST</span><span class="c5">&nbsp;sets the ITEST to whatever value
is currently in the X-register.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">INCR (I, J, K, L, M or N) ,
i</span><span class="c1">&nbsp; - The "INCR" command causes the
value in the indicated index register "I", "J","K", "L", "M" or
"N") to be incremented by "i", a numeric value which may be
positive or negative. If a numeric value is not specified, the
default numeric value of 1.0 is used. "INCR" can be used with all
named registers.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c5 c9">Example:</span><span class=
"c5 c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INCR I,
.5</span><span class="c5">&nbsp;increments the value in the I
register by 0.5</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">BRANCHING
COMMANDS</span><span class="c1">&nbsp;- Branching commands are used
to select alternative sequences of command processing within a
macro. Branching commands may appear anywhere within a macro. These
branching commands are not quire the "IF-THEN-ELSE-ENDIF" of
FORTRAN but their low level nature makes them extremely
flexible.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BP (branch point name)</span>
<span class="c1">&nbsp;- The "BP" command defines a branch point
having the name "branch point name". The branch point name is
entered as a qualifier word. A branch point serves only as a marker
and may appear anywhere within a macro. Branch commands refer to a
branch point by name indicating that if the branch is taken, the
next command processed is the command immediately following the
named branch point. (This is similar to a LABEL in a programmable
calculator program.) Branch point names must begin with one of the
26 characters of the alphabet and may not exceed eight alphanumeric
characters in length.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRQ (branch point name) , (test
name)</span><span class="c1">&nbsp; - The "BRQ" command specifies
that if the current qualifier word of the macro (the qualifier word
used in the macro invocation line or the qualifier as defined by
the "QSUB DV" command) matches the indicated name test name, then
the next command to be processed is the command immediately
following the branch point named "branch point name". If no match
exists, the "BRQ" command results in no action and macro processing
continues sequentially.</span></p>
<hr style="page-break-before:always;display:none;">
<p class="c6 c7"></p>
<p class="c6"><span class="c2">ABOUT LINE COUNTS
"lc"</span><span class="c1">&nbsp;- In the branching commands which
follow, a numeric line count, or "lc", may be used. If a non-zero
"lc" has been entered, it is used instead of the branch point name
to determine the location of the next command to be processed when
branching takes place. If no entry is made for "lc", then the
branch point named "branch point name" is used and the macro is
searched for "BP branch point name". The line count "lc" may be
positive or negative. It specifies the position of the next command
to be processed relative to the position of the branch command when
branching takes place. A value of "lc" = -9 indicates a branch to a
command which is nine commands back from the branch command. The
use of "lc" reduces the need for branch points but makes a macro
harder to read. Avoid the use of "lc" unless there is no choice.
"lc" is intended for use with macros written using HEXAGON, the old
Hughes Aircraft Co. program.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRERR (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRERR" command, which stands
for Branch on Read ERRor, causes branching to "BP branch point
name" if the read error flag has been set. The read error flag is
set by an unsuccessful execution of the "ATON" &nbsp;CMD level
command. The "ATON" command is used to attempt to convert the first
23 characters read by the CMD level "PREAD" command into a numeric
value. After the branching occurs, the read error flag is
cleared.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BPOS (branch point name) ,
lc</span><span class="c1">&nbsp;or</span> <span class=
"c0">IF(X&gt;0) (branch point name) , lc</span><span class=
"c1">&nbsp;- The "BPOS" or "IF(X&gt;0)"command causes branching to
"BP branch point name" if the value in the accumulator
("X"-register) is positive.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BNEG (branch point name) ,
lc</span><span class="c1">&nbsp;or</span> <span class=
"c0">IF(X&lt;0) (branch point name) , lc</span><span class=
"c1">&nbsp;- The "BNEG" or "IF(X&lt;0)"command causes branching to
"BP branch point name" if the value in the accumulator is
negative.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BZE (branch point name) ,
lc</span><span class="c1">&nbsp;or</span> <span class="c0">IF(X=0)
(branch point name) , lc</span><span class="c1">&nbsp;- The "BZE"
or "IF(X=0)" command causes branching to "BP branch point name" if
the value in the accumulator is zero.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">IF(X=Y) (branch point name) ,
lc</span><span class="c1">&nbsp;- The "IF(X=Y)" command causes
branching to "BP branch point name" if the value in the X-register
is equal to the value in the Y-register.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">IF(X&gt;Y) (branch point name) ,
lc</span><span class="c1">&nbsp;- The "IF(X&gt;Y)"command causes
branching to "BP branch point name" if the value in the X-register
is greater than the value in the Y-register.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">IF(X&lt;Y) (branch point name) ,
lc</span><span class="c1">&nbsp;- The "IF(X&lt;Y)"command causes
branching to "BP branch point name" if the value in the X-register
is less than the value in the Y-register.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRI (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRI" command causes
branching to "BP branch point name" if index register "I" equals
"ITEST".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRJ (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRJ" command causes
branching to "BP branch point name" if index register "J" equals
"JTEST".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRK (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRK" command causes
branching to "BP branch point name" if index register "K" equals
"KTEST".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRL (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRL" command causes
branching to "BP branch point name" if index register "L" equals
"LTEST".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRM (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRM" command causes
branching to "BP branch point name" if index register "M" equals
"MTEST".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRN (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRN" command causes
branching to "BP branch point name" if index register "N" equals
"NTEST".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRDQ (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRDQ" command causes
branching to "BP branch point name" if the qualifier in the macro
invocation line was not explicitly entered or provided with a
"QSUB" command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRDF1 (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRDF1" command causes
branching to "BP branch point name" if the numeric word #1 in the
macro invocation line was not explicitly entered or provided with
an "NSUB DV" command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRDF2 (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRDF2" command causes
branching to "BP branch point name" if the numeric word #2 in the
macro invocation line was not explicitly entered or provided with
an "NSUB DV" command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRDF3 (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRDF3" command causes
branching to "BP branch point name" if the numeric word #3 in the
macro invocation line was not explicitly entered or provided with
an "NSUB DV" command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRDF4 (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRDF4" command causes
branching to "BP branch point name" if the numeric word #4 in the
macro invocation line was not explicitly entered or provided with
an "NSUB DV" command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRDF5 (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRDF5" command causes
branching to "BP branch point name" if the numeric word #5 in the
macro invocation line was not explicitly entered or provided with
an "NSUB DV" command.</span></p>
<hr style="page-break-before:always;display:none;">
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRU (branch point name) ,
lc</span><span class="c1">&nbsp;- The "BRU" command causes
branching unconditionally to "BP branch point name".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRANCH (branch point name) , i , j ,
lc</span><span class="c1">&nbsp;- The "BRANCH" command causes
branching to "BP branch point name" if "i"th numeric word in the
macro invocation line has the value "j". If no branch point name is
given and "lc" is non-zero, then a jump of "lc" lines is
performed.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">FLAGS IN
BRANCHING</span><span class="c1">&nbsp;- Up to 20 user flags may be
set, tested and cleared. Setting and clearing of these flags is
covered in the CMD section of this manual. Two commands can be used
to test the value of up to five of these flags at any one time. If
f</span><span class="c1 c16">i</span><span class="c1">&nbsp;is
positive, then flag f</span><span class=
"c1 c16">i</span><span class="c1">&nbsp;satisfies the test if flag
f</span><span class="c1 c16">i</span><span class="c1">&nbsp;is set
on. If f</span><span class="c1 c16">i</span><span class=
"c1">&nbsp;is negative, then flag f</span><span class=
"c1 c25">i</span> <span class="c1">satisfies the test if flag
f</span><span class="c1 c16">i</span><span class="c1">&nbsp;is set
off.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRT (branch point name), f1 , f2 ,
f3 , f4 , f5</span><span class="c1">&nbsp;- The "BRT" command
causes branching to "BP branch point name" only if all specified
flags test on.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BRF (branch point name), f1 , f2 ,
f3 , f4 , f5</span><span class="c1">&nbsp;- The "BRF" command
causes branching to "BP branch point name" if not all specified
flags test on.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">FLAG EXAMPLES</span><span class=
"c1">&nbsp;- If flags 2, 4 and 5 are set "off" and 1 and 3 are
"on", then</span><span class="c5">&nbsp;</span><span class=
"c5 c11">"BRT ABC , 1 , 3</span><span class=
"c1 c11">"</span><span class="c1">&nbsp;will cause branching to
branch point ABC and</span><span class=
"c5">&nbsp;</span><span class="c5 c11">"BRF DEF , 2 , 4 ,
5"</span><span class="c5">&nbsp;</span><span class="c1">will cause
branching to branch point DEF.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">TERMINATION OF EXECUTION</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">RETURN</span><span class=
"c1">&nbsp;- The "RETURN" command terminates a macro's execution
and passes control back to the calling macro if there was one.
Macro execution also terminates if the bottom of the macro "EOM" is
reached and the preceding command is not a branch
command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">EXTERNAL DATA
TRANSFER</span><span class="c1">&nbsp;- The following commands are
external data transfer commands. External data transfer commands
are used to transfer data from the macro invocation line directly
into a normal program command line contained within that macro.
External data transfer commands are also used to transfer data to
and from the accumulator or X-register. The following external data
transfer commands modify the next normal program command
encountered after the data transfer command is encountered. Up to
ten data transfer commands may precede a normal program command to
be modified.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">CSUB</span><span class="c1">&nbsp;-
The "CSUB" command replaces the command word of the command to be
modified with either the qualifier word issued in the macro
invocation line or the qualifier word supplied with a "QSUB DV"
command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">QSUB</span><span class="c1">&nbsp;-
The "QSUB" command replaces the qualifier word of the command to be
modified with either the qualifier word issued in the macro
invocation line or the qualifier word supplied with a "QSUB DV"
command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">QRSUB</span><span class="c1">&nbsp;-
The "QRSUB" command replaces the qualifier word of the command to
be modified with the first eight characters of the last string read
by a prompted read via the "PREAD" command described in the CMD
section of this manual.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">SSUB</span><span class="c1">&nbsp;-
The "SSUB" command replaces the alphanumeric string of the command
to be modified with the alphanumeric string issued in the macro
invocation line or the alphanumeric string supplied with an "SSUB
DV" command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">CRSUB</span><span class="c1">&nbsp;-
The "CRSUB" command replaces the command word of the command to be
modified with the first eight characters of the last string read by
a prompted read via the "PREAD" command described in the CMD
section of this manual.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">DEFAULT INPUT DATA</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">QSUB DV (default qualifier word
value)</span><span class="c1">) - The "QSUB DV" command is used to
set a non-blank default value for the qualifier word of the macro
invocation line. This default value is used only when the macro
invocation line contains no qualifier word.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">SSUB DV (default alphanumeric string
word value)</span><span class="c1">) - The "SSUB DV" command is
used to set a non-blank default value for the alphanumeric string
word of the macro invocation line. This default value is used only
when the macro invocation line contains no alphanumeric string
input word.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">ACCSUB (register name) ,
i</span><span class="c1">&nbsp;- The "ACCSUB" command will
substitute the named register for the accumulator during the
subsequent "i" valid program commands. The accumulator will remain
unchanged, and operations which normally operate upon the
accumulator will operate upon the named register. All arithmetic
processing commands and "STORE", "CSUB", "QSUB", "PUTR" and "WRITE"
are valid for "ACCSUB". If a command invalid for accumulator
substitution is encountered, it is processed without the
substitution. If &nbsp;"i" is not specified, the default value is
taken to be 1.0 .</span></p>
<hr style="page-break-before:always;display:none;">
<p class="c6 c7"></p>
<p class="c6"><span class="c2">NUMERIC DATA
TRANSFER</span><span class="c1">&nbsp;- The following external data
transfer commands modify numeric entries. &nbsp;In all cases the
first numeric word is the location where the value goes "to" and
the second numeric word is the location where the value comes
"from". Remember, "TO" and "FROM",</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">NSUB , j , k , A , B,
C</span><span class="c1">&nbsp;- The "NSUB" command causes the
numeric value of numeric word "j" of the command to be modified to
be replaced by:</span></p>
<p class="c17" id="h.gjdgxs"><span style=
"overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 123.07px; height: 23.07px;">
<img alt="" src="ml_images/image1.png" style=
"width: 123.07px; height: 23.07px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
title=""></span></p>
<p class="c6"><span class="c3 c1">where "vk" is the numeric value
of numeric word "k" of the macro invocation line. Both j and k are
restricted to values 0, 1, 2, 3, 4 or 5. &nbsp;0 refers &nbsp;to
the accumulator or X-register. Default values are:</span></p>
<p class="c17"><span class="c3 c1">A = 1.0</span></p>
<p class="c17"><span class="c3 c1">B = 0.0</span></p>
<p class="c17"><span class="c3 c1">C = 1.0</span></p>
<p class="c14 c7"></p>
<p class="c6"><span class="c0">NSUB RA , j , k , l, B,
C</span><span class="c1">&nbsp;- The "NSUB RA" command is
equivalent to the "NSUB, j , k , A , B , C" command, except that
the numeric value of numeric word "l" (lower case L, not 1) of the
macro invocation line is used as the multiplicative constant,
"A".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">NSUB RB , j, k , A , m,
C</span><span class="c1">&nbsp;- The "NSUB RB" command is
equivalent to the "NSUB, j , k , A , B , C" command, except that
the numeric value of numeric word "m" of the macro invocation line
is used as the additive constant, "B".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">NSUB RC, j , k , A , B ,
n</span><span class="c1">&nbsp;- The "NSUB RC" command is
equivalent to the "NSUB , j , k , A , B, C" command, except that
the numeric value of numeric word "n" of the macro invocation line
is used as the power constant, "C".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">NSUB RAB, j , k , l , m ,
C</span></p>
<p class="c6"><span class="c0">NSUB RAC , j , k , l , B ,
n</span></p>
<p class="c6"><span class="c0">NSUB RBC , j , k , A , m ,
n</span></p>
<p class="c6"><span class="c0">NSUB RABC , j , k , l , m ,
n</span><span class="c1">&nbsp; - These commands are combinations
of the "RA", "RB" and "RC" NSUB commands.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">DEFAULT NUMERIC VALUES</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">NSUB DV, NW1, NW2, NW3, NW4,
NW5</span><span class="c1">&nbsp;- The "NSUB DV" command is used to
set default values for the five numeric words of the macro
invocation command. They are used to replace values of the numeric
words left default or blank on the macro invocation
line.</span></p>
<p class="c6"><span class="c3 c1">NOTES:</span></p>
<p class="c6"><span class="c3 c1">1. In all numeric data transfer
commands, the second numeric value in any "NSUB" command (except
"NSUB DV") is the address in the macro invocation line from which
the value to be transferred is to be found.</span></p>
<p class="c6"><span class="c3 c1">2. In all numeric data transfer
commands, the first numeric value in any "NSUB" command (except
"NSUB DV") is the address in the next non-NSUB command to which the
value to be transferred will be transferred.</span></p>
<p class="c6"><span class="c3 c1">3. In any "NSUB" command, a zero
for numeric word j or k always means the accumulator. j = 0 causes
transfer into the accumulator register; k = 0 causes transfer from
the accumulator register. This is the ONLY case where an "NSUB"
command does not modify another command.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">OTHER DATA TRANSFERS</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MOVE NW , i</span><span class=
"c1">&nbsp;- The "MOVE NW" command is a special case of the "MOVE"
command described in the arithmetic processor command section of
the CMD section of this manual. The numeric value of the "i" th
numeric word of the macro invocation line is moved into the
accumulator. If "i" is zero, the value stored in the index register
"I" is used in place of &nbsp;"i". If the integer value of the "I"
register is equal to 0.0 or is greater than 5.0, then the integer
value of the first numeric word is moved into the
accumulator.</span></p>
<hr style="page-break-before:always;display:none;">
<p class="c6"><span class="c0">PUTR (register name) ,
i</span><span class="c1">&nbsp;- The "PUTR" command causes the
numeric value of numeric word "i" of the macro invocation line to
be replaced by the value of the number in the named &nbsp;register.
If "i" is zero, value of the index register "I" is used in place of
"i". If the value of the "I" register is equal to 0 or if it is
greater than 5, then the value stored in the named register is
moved into the first numeric word of the macro invocation
line.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">NESTING MOVE WITH
NSUB</span><span class="c1">&nbsp;- The "MOVE" command may be
nested with "NSUB" commands when NSUBing from the
accumulator.</span></p>
<p class="c6"><span class="c3 c1">Example:</span></p>
<p class="c6"><span class=
"c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c5 c11">SET
A 3</span></p>
<p class="c6"><span class=
"c10 c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET
B 4</span></p>
<p class="c6"><span class=
"c10 c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET
C 5</span></p>
<p class="c6"><span class=
"c10 c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE
C</span></p>
<p class="c6"><span class=
"c10 c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSUB
1 0</span></p>
<p class="c6"><span class=
"c10 c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE
&nbsp;A</span></p>
<p class="c6"><span class=
"c5 c10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSUB
2 0</span></p>
<p class="c6"><span class=
"c10 c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE
B</span></p>
<p class="c6"><span class=
"c10 c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NSUB
3 0</span></p>
<p class="c6"><span class=
"c10 c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOB</span></p>
<p class="c6"><span class="c3 c1">is identical to issuing the
command</span></p>
<p class="c6"><span class=
"c5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c5 c11">FOB
5 , 3 , 4</span></p>
<p class="c6"><span class="c3 c1">The first three commands store 3,
4 and 5 into the registers A, B and C.</span> <span class=
"c10 c5">"MOVE C"</span><span class="c3 c1">&nbsp;moves 5 to the
accumulator.</span> <span class="c10 c5">"NSUB 1
0"</span><span class="c3 c1">&nbsp;moves the accumulator value into
the first numeric word of</span> <span class=
"c10 c5">"FOB"</span><span class="c3 c5">&nbsp;</span><span class=
"c3 c1">.</span> <span class="c10 c5">"MOVE A"</span><span class=
"c3 c1">&nbsp;moves 3 to the accumulator.</span> <span class=
"c10 c5">"NSUB 2 0"</span><span class="c3 c1">&nbsp;moves the
accumulator value into the second numeric word of</span>
<span class="c10 c5">"FOB"</span><span class=
"c3 c5">&nbsp;</span><span class="c3 c1">.</span> <span class=
"c10 c5">"MOVE B"</span><span class="c3 c1">&nbsp;moves 4 to the
accumulator.</span> <span class="c10 c5">"NSUB 3
0"</span><span class="c3 c1">&nbsp;moves the accumulator value into
the first numeric word of</span> <span class=
"c10 c5">"FOB"</span><span class="c3 c5">&nbsp;</span><span class=
"c3 c1">.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO NESTING</span><span class=
"c1">&nbsp;- When a macro is invoked from within another macro, the
macro is said to be "nested". If the nested macro invokes another
macro, that macro is said to be nested at a level of two. Macro
nesting is permitted up to a level of twenty. Two commands are
provided to preserve the contents of the named registers (not the
general purpose registers, however). These named registers are
discussed in the CMD section of this manual.</span></p>
<p class="c6"><span class="c3 c1">NOTE: Macro functions, when they
are used in the definitions of optimization operands, and macro
functions FUN09 and FUN10, when used for special surfaces #5 and
#11 definitions, do not support nesting. In these limited
circumstances, they may not invoke macros or other macro
functions.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">SAVE</span><span class="c1">&nbsp;-
The "SAVE" command causes the current contents of the accumulator
(register X) and registers A through H, Y, Z, T, IX, IY, IZ , I, J,
ITEST, JTEST, LASTX and LASTIX to be saved.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">RELOAD</span><span class=
"c1">&nbsp;- The "RELOAD" command causes contents of the registers
to be restored to the values which were saved by the last "SAVE"
command issued at this nesting level. "SAVE" and "RELOAD" are
operational at each of the 20 macro nesting levels.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">TRACING MACRO
EXECUTION</span><span class="c1">&nbsp;- To trace the execution of
a macro or macros (useful in debugging), the following two commands
are provided:</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">TRACE ON</span><span class=
"c1">&nbsp;- The "TRACE ON" command commences tracing the execution
of all non-macro processing commands at the</span></p>
<p class="c6"><span class="c3 c1">current nesting level. If a macro
invokes another macro, that macro will only be traced if it
contains a "TRACE ON" command as well.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">TRACE OFF</span><span class=
"c1">&nbsp;- This command terminates tracing at the current nesting
level.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">SINGLE STEP MACRO
EXECUTION</span><span class="c1">&nbsp;- To single step through the
execution of a macro or macros (useful in debugging), the following
two commands are provided:</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">SSTEP ON</span><span class=
"c1">&nbsp;- The "SSTEP ON" command commences single step execution
of all commands at the current nesting level. If a macro invokes
another macro, that macro will only be single stepped if it
contains a "SSTEP ON" command as well. During single stepping,
pressing of any key on the keyboard causes the next macro command
to be processed. There is an option to stop macro
execution.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">SSTEP OFF</span><span class=
"c1">&nbsp;- This command terminates single step execution at the
current nesting level.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">PAUSING MACRO
EXECUTION</span><span class="c1">&nbsp;- To pause the execution of
a macro at a specific line, the following command is
provided:</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">PAUSE</span><span class="c1">&nbsp;-
The "PAUSE" command causes macro execution to be temporarily
suspended at the location of the "PAUSE" command. Macro execution
is resumed by pressing any key on the keyboard.</span></p>
<hr style="page-break-before:always;display:none;">
<p class="c6 c7"></p>
<p class="c6"><span class="c2">AUTOMATIC MACRO
TERMINATION</span><span class="c1">&nbsp;- By default, when a
program command is run from within a macro and when that command's
execution results in an error message, the macro from which that
command was issued and any macros asssociated with that macro which
exist in a macro nest will be automatically terminated. This
protects the user from runaway macros. If this automatic macro
termination is not desired, the following command is provided in
order that the user can turn "on" or "off" this automatic macro
termination feature.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MACFAIL (ON</span> <span class=
"c5 c9">or</span><span class="c0">&nbsp;OFF</span> <span class=
"c5 c9">or</span><span class="c0">&nbsp;YES</span> <span class=
"c5 c9">or</span><span class="c0">&nbsp;NO)</span><span class=
"c1">&nbsp;- The "MACFAIL" command, issued from the CMD program
level, is used to either enable or disable automatic macro
termination in the presence of a program error condition. Issued
with no input or with the "?", the current state of automatic macro
termination will be displayed. "ON" or "YES" is the program default
condition</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">RENAMING / COPYING
MACROS</span><span class="c1">&nbsp;- The following commands are
used to rename and copy macros.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MRENAME (current macro name) (new
macro name)</span><span class="c1">&nbsp;- The command "MRENAME"
requires explicit qualifier word and alphanumeric string input. The
new macro named "new macro name" is created and the current macro
named "current macro name" is extracted into it. Then the old macro
is deleted.</span></p>
<p class="c6"><span class="c3 c1">NOTE: This command may also be
issued via the main program GUI interface menu system.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MCOPY (current macro name) (new
macro name)</span><span class="c1">&nbsp; - The command "MCOPY"
requires explicit qualifier word and alphanumeric string input. The
new macro named "new macro name" is created and the current macro
named "current macro name" is extracted into it. The old macro is
left on file.</span></p>
<p class="c6"><span class="c3 c1">NOTE: This command may also be
issued via the main program GUI interface menu system.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO DIRECTORY FILE
REPAIR</span><span class="c1">&nbsp;- In the event that one or more
of the MACXXX.DAT macro body data files becomes damaged or is
inadvertently deleted, some of the macro commands will issue a
message that the macro directory file is damaged. To repair this
damage, do the following:</span></p>
<p class="c6"><span class="c3 c1">1) From the CMD level, issue an
MFLN command and write down the names of the macros listed. This is
a list of the macro names in the directory.</span></p>
<p class="c6"><span class="c3 c1">2) From the CMD level, issue an
MFLC command. Write down the names of all macros which are listed
with the MFLC command.</span></p>
<p class="c6"><span class="c3 c1">3) Any Macro name which appears
in the list from the MFLN command, but not in the list from the
MFLC command, should be deleted using the MDEL command. The body of
these Macros is already gone; you are simply correcting the macro
directory file.</span></p>
<p class="c6"><span class="c3 c1">NOTE: If the problem persists,
contact Engineering Calculations! We want to make sure you are not
seeing a BUG!</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MANIPULATING &nbsp;MACRO
LIBRARIES</span><span class="c1">&nbsp;- The following commands are
used to save and restore the contents of the current macro
directory file.</span></p>
<p class="c6"><span class="c5">WARNING:</span><span class=
"c1">&nbsp;These two next two commands should not be used for
saving and restoring the macro library when updating the program.
The behavior of these commands in this situation is not reliable
and alternate macro libraries will be lost!!!!!</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MACSAVE</span><span class=
"c1">&nbsp;- The command "MACSAVE" causes the contents of the
current macro directory to be saved in the ASCII file MACSAV.DAT.
This process erases the current contents of the EDITTEXT.DAT file
and the previous contents of the MACSAV.DAT file.</span></p>
<p class="c6"><span class="c3 c1">NOTE: This command may also be
issued via the main program GUI interface menu system.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">MACREST</span><span class=
"c1">&nbsp;- The command "MACREST" causes the contents of the
current MACSAV.DAT file to be loaded into the current macro
directory. This process erases the current contents of the
EDITTEXT.DAT file and the previous contents of the current macro
directory.</span></p>
<p class="c6"><span class="c1">NOTE: This command may also be
issued via the main program GUI interface menu system.</span></p>
<hr style="page-break-before:always;display:none;">
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO EDITING WITH
LMEDIT</span><span>&nbsp;- As was mentioned earlier, there in an
older, line oriented editor which was the original macro editor and
which works exactly like the horrible line editor in the HEXAGON
program (the program I reverse engineered to make this program).
For those who like history and pain, it has been left in the
program. It is for old HEXAGON users who didn't have a full screen
editor and LIKED IT THAT WAY!</span> <span class="c1">The "LMEDIT"
command can be used either to initiate editing of an existing macro
or to create a new macro in the macro-edit mode:</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">LMEDIT (macro
name)</span><span class="c1">&nbsp; - If the named macro already
exists in the macro directory file, the named macro is transferred
in its entirety from the macro directory file into a memory area
where it is available for editing. At this point, the program is
shifted to the MEDIT sub-level. If the named macro is new, the
message "CREATING A NEW MACRO WITH LMEDIT" is printed, and the body
of the new macro may be entered as in the macro creation mode. If a
new macro is being created using "LMEDIT", the new macro is written
in memory and is not entered into the macro directory file until
the "FL" command (to be described) is issued. The key to
understanding the use of this LMEDIT mode is the line pointer
concept. The lines containing the commands which make up a macro
are numbered sequentially in the memory area. The line pointer
indicates the macro line number currently under edit consideration.
As new macro lines are entered, the pointer is incremented so that
it "points to" the most recently entered line. When the "LMEDIT
macro name" command is issued, the line pointer is set to zero. As
soon as another macro line is entered, the pointer is set to "1",
etc. Any entry which is not one of the special editing commands
(described in the next section) is entered as a line in the macro
body following the position currently indicated by the pointer.
Then the pointer is incremented by "1". The "LMEDIT" command may
not be issued from within a macro (i.e., a macro cannot LMEDIT
another macro or itself).</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">MACRO EDIT (LMEDIT)
COMMANDS</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">BT</span><span class="c1">&nbsp;-
The "BT" command positions the macro line pointer to the last line
(bottom) of the macro. Any input which follows this command is
added at the end of the macro and becomes the new last
line.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">DE , i</span><span class="c1">&nbsp;
- The "DE" command deletes "i" lines from the macro beginning with
the current line. If no entry is made for "i", just the current
line is deleted (i.e. no entry is equivalent to i = 1). After
deletion, the line pointer is positioned at the line following the
last line deleted.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">EX (macro name) , i ,
j</span><span class="c1">&nbsp; - The "EX" command extracts lines
"i" through line "j" of the named macro and inserts these lines
after the current line of the macro being edited. The line pointer
is left at the last line extracted. If the named macro is not found
in the macro directory file, a message to that effect is printed
and the line pointer is not moved. If no entry is made for "i" or
"j", the entire named macro is extracted. If no entry is made for
"j" but "i" is given, lines "i" through the end of the named macro
are extracted.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">GO , i</span><span class="c1">&nbsp;
- The "GO" command sets the macro line pointer at line "i" and
displays that line. Any input entered after issuing "GO, i" is
inserted after line "i". If no entry is made for "i", the line
pointer is positioned at the top of the macro (equivalent to "GO,
0").</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">LO C (command word search
target)</span><span class="c1">&nbsp; - The "LO C" command causes
the macro to be searched (starting from the line immediately
following the current line) for a line containing the specific
command word. The search terminates when the end of the macro is
reached. If the command word is found, the line containing that
word becomes the new current line. If the specified command word is
not found, a message to that effect is displayed and the line
pointer is positioned at the bottom of the macro.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">LO Q (qualifier word search
target)</span><span class="c1">&nbsp; - The "LO Q" command
functions in the same manner as the "LO C" command, except that the
search is made for a qualifier word matching the specified
word.</span></p>
<p class="c6"><span class="c0">LO CQ (command and qualifier word
search target)</span><span class="c1">&nbsp; - The "LO CQ" command
causes the macro to be searched for a line containing both the
specified command word and specified qualifier word. The target
command and qualifier words are entered as one string using one
colon. They are separated by one or more blanks.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">LO COQ (command or qualifier word
search target)</span><span class="c1">&nbsp; - The "LO COQ" command
causes the macro to be searched for a line containing the specified
word, either as a command or as a qualifier word.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">NEXT</span><span class="c1">&nbsp;-
The "NEXT" command repeats the last search, thus avoiding
considerable retyping of locate commands.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">PR , i</span><span class="c1">&nbsp;
- The "PR" command causes "i" lines of the macro to be displayed
beginning with the current line. If no entry for "i" is made, just
the current line is printed. If "PR, i" is entered immediately
following "PR", then "i" lines starting with the next line are
displayed. The line pointer is always left at the last line
displayed.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">QUIT</span><span class=
"c1">&nbsp;or</span> <span class="c0">QU</span><span class=
"c1">&nbsp;- The "QUIT" or "QU" command terminates the macro
editing session and returns the program to the CMD level without
writing the current macro to the macro directory file. The current
macro which was being entered is lost.</span></p>
<hr style="page-break-before:always;display:none;">
<p class="c6"><span class="c0">RE &nbsp;(new text of line being
replaced)</span><span class="c1">&nbsp; - The "RE" command causes
the current macro line to be replaced by the specified text. The
macro line pointer remains unchanged.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">TP</span><span class="c1">&nbsp;-
The "TP" command positions the macro line pointer to the top of the
macro. Any input entered following this command will precede all
existing lines in the macro.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">FL</span><span class="c1">&nbsp;-
The "FL" command writes the current edited macro into the macro
directory file and returns the program to the CMD level. If the
macro has no lines, a warning message to that effect is printed and
no macro is stored.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c8 c19">ADVANCED STUFF (FOR EXPERTS
ONLY)</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c2">BUILDING A NEW
COMMAND</span><span class="c1">&nbsp;-</span> <span class=
"c5 c21">The following commands are almost never needed except if
you are writing a macro which is intended to create a new macro or
which is intended to have advanced "intelligence". Unless you feel
fearless, just ignore what follows.</span><span class=
"c1">&nbsp;The following commands were designed to be used both
from the CMD level and from within macros. They are described here
because their real value comes from their use inside macros. The
philosophy behind these commands is as follows:</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">CWORD (the command word of the
command under construction)</span><span class="c1">&nbsp; - The
command "CWORD" takes qualifier word input. If we were building the
command "RTG ALL", the input following "CWORD" would be
"RTG".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">QWORD (the qualifier word of the
command under construction)</span><span class="c1">&nbsp; - The
command "QWORD" takes qualifier word input. If we were building the
command "RTG ALL", the input following "QWORD" would be
"ALL".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">STWORD (the alphanumeric string of
the command under construction)</span><span class="c1">&nbsp; - The
command "STWORD" takes alphanumeric input. If we were building the
command "M, Hello world !", the input following "STWORD" would be
"Hello world !".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">N1WORD , i</span><span class=
"c1">The command "N1WORD" takes numeric word #1 input. If we were
building the command "RTG , 2", the input following "N1WORD " would
be "2".</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">N2WORD , i &nbsp;</span><span class=
"c1 c9">and</span></p>
<p class="c6"><span class="c0">N3WORD , i &nbsp;</span><span class=
"c1 c9">and</span></p>
<p class="c6"><span class="c0">N4WORD , i &nbsp;</span><span class=
"c1 c9">and</span></p>
<p class="c6"><span class="c0">N5WORD , i</span><span class=
"c1">&nbsp;- The commands "N2WORD", "N3WORD", "N4WORD" and "N5WORD"
are similar to "N1WORD" and are used for setting up numeric words
2, 3, 4 and 5.</span></p>
<p class="c6 c7"></p>
<p class="c6"><span class="c0">NEWCMD CLEAR</span><span class=
"c1">&nbsp;- The "NEWCMD CLEAR" command clears the internal program
storage areas set aside for the command under construction. This
&nbsp;command should be used prior to the building of a new
command.</span></p>
<p class="c17 c7"></p>
<p class="c6"><span class="c0">NEWCMD</span><span class=
"c1">&nbsp;</span><span class="c3 c4">&nbsp;- The "NEWCMD" command
causes the newly-built program command to executed. In summary, if
the command "RTG ALL" was to be constructed and executed from
within a macro, the macro lines which could perform the task would
be:</span></p>
<a id="t.fd55fbb3f6864bd20c8c82ee75bd65f89db34e03"></a><a id=
"t.0"></a>
<table class="c15">
<tbody>
<tr class="c13">
<td class="c20" colspan="1" rowspan="1">
<p class="c6"><span class="c10 c5">CWORD RTG</span></p>
</td>
</tr>
<tr class="c13">
<td class="c20" colspan="1" rowspan="1">
<p class="c6"><span class="c10 c5">QWORD ALL</span></p>
</td>
</tr>
<tr class="c13">
<td class="c20" colspan="1" rowspan="1">
<p class="c6"><span class="c10 c5">NEWCMD</span></p>
</td>
</tr>
</tbody>
</table>
<p class="c6 c7"></p>
<div>
<p class="c17 c7 c18"></p>
</div>
</body>
</html>
